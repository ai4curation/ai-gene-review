<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mxaD - AI Gene Review</title>
    <style>
        :root {
            --color-accept: #22c55e;
            --color-remove: #ef4444;
            --color-modify: #f97316;
            --color-keep-non-core: #3b82f6;
            --color-undecided: #6b7280;
            --color-new: #8b5cf6;
            --color-mark-over: #eab308;
            --bg-light: #f9fafb;
            --border-color: #e5e7eb;
            --text-muted: #6b7280;
            --text-primary: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: #ffffff;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 1.5rem;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #1f2937;
        }

        .gene-info {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .info-item {
            display: flex;
            gap: 0.5rem;
        }

        .info-label {
            font-weight: 600;
            color: var(--text-muted);
        }

        .aliases {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            background-color: var(--bg-light);
            border: 1px solid var(--border-color);
        }

        .status-badge {
            padding: 0.375rem 0.875rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .status-initialized {
            background-color: #fef3c7;
            color: #92400e;
            border: 1px solid #fde68a;
        }

        .status-in-progress {
            background-color: #dbeafe;
            color: #1e40af;
            border: 1px solid #bfdbfe;
        }

        .status-draft {
            background-color: #fce7f3;
            color: #831843;
            border: 1px solid #fbcfe8;
        }

        .status-complete {
            background-color: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
        }

        .description-card {
            background-color: var(--bg-light);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .description-card h2 {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: #374151;
        }

        .section {
            margin-bottom: 2.5rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #1f2937;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.5rem;
        }

        .annotations-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .annotations-table thead {
            background-color: var(--bg-light);
        }

        .annotations-table th {
            text-align: left;
            padding: 1rem;
            font-weight: 600;
            border-bottom: 2px solid var(--border-color);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        .annotations-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .annotations-table tbody tr:hover {
            background-color: #f9fafb;
        }

        .action-badge {
            display: inline-block;
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .action-accept {
            background-color: var(--color-accept);
            color: white;
        }

        .action-remove {
            background-color: var(--color-remove);
            color: white;
        }

        .action-modify {
            background-color: var(--color-modify);
            color: white;
        }

        .action-keep_as_non_core {
            background-color: var(--color-keep-non-core);
            color: white;
        }

        .action-undecided {
            background-color: var(--color-undecided);
            color: white;
        }

        .action-new {
            background-color: var(--color-new);
            color: white;
        }

        .action-mark_as_over_annotated {
            background-color: var(--color-mark-over);
            color: white;
        }

        .term-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .term-id {
            font-family: monospace;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .term-label {
            font-weight: 500;
        }

        .evidence-code {
            font-family: monospace;
            background-color: var(--bg-light);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .core-function-card {
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .core-function-card h3 {
            font-size: 1.125rem;
            margin-bottom: 1rem;
            color: #1f2937;
        }

        .core-function-statement {
            margin-bottom: 1rem;
            padding: 0.75rem;
            background-color: var(--bg-light);
            border-left: 4px solid var(--color-accept);
            border-radius: 0.25rem;
        }

        .function-annotations {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .reference-item {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .reference-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 0.75rem;
        }

        .reference-id {
            font-family: monospace;
            font-weight: 600;
            color: #2563eb;
        }

        .supported-by {
            margin-top: 0.5rem;
            padding: 0.5rem;
            background-color: #f3f4f6;
            border-left: 3px solid #3b82f6;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .supported-by-title {
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }

        .support-item {
            margin-bottom: 0.5rem;
        }

        .support-ref {
            font-weight: 500;
            color: #2563eb;
        }

        .support-text {
            color: #6b7280;
            font-style: italic;
            margin-left: 1rem;
        }

        a.term-link {
            color: #2563eb;
            text-decoration: none;
        }

        a.term-link:hover {
            text-decoration: underline;
        }

        .core-function-terms {
            margin-top: 1rem;
        }

        .function-term-group {
            margin-bottom: 1rem;
        }

        .function-term-label {
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 0.25rem;
        }

        .reference-title {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .findings-list {
            margin-top: 1rem;
            padding-left: 1.5rem;
        }

        .finding-item {
            margin-bottom: 0.75rem;
        }

        .finding-statement {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .finding-text {
            color: var(--text-muted);
            font-size: 0.95rem;
            font-style: italic;
        }

        .proposed-term {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #fef3c7;
        }

        .question-card {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #dbeafe;
        }

        .experiment-card {
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #f3e8ff;
        }

        .collapsible {
            cursor: pointer;
            user-select: none;
        }

        .collapsible:after {
            content: ' ‚ñº';
            font-size: 0.75rem;
        }

        .collapsible.collapsed:after {
            content: ' ‚ñ∫';
        }

        .collapse-content {
            transition: max-height 0.3s ease;
            overflow: hidden;
        }

        .collapsed + .collapse-content {
            max-height: 0;
        }

        .no-data {
            color: var(--text-muted);
            font-style: italic;
            padding: 1rem;
            text-align: center;
            background-color: var(--bg-light);
            border-radius: 0.5rem;
        }

        /* Styling for markdown section summaries with voting */
        .markdown-section summary {
            padding: 0.75rem;
            background: var(--bg-light);
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .markdown-section summary:hover {
            background: #e5e7eb;
        }

        .markdown-section summary .vote-buttons {
            margin-left: auto;
        }

        @media print {
            body {
                padding: 1rem;
            }

            .collapsible:after {
                display: none;
            }

            .collapsed + .collapse-content {
                max-height: none !important;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            h1 {
                font-size: 2rem;
            }

            .annotations-table {
                font-size: 0.875rem;
            }

            .annotations-table th,
            .annotations-table td {
                padding: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>mxaD</h1>
        <div class="gene-info">
            
            <div class="info-item">
                
                <span class="info-label">UniProt ID:</span>
                <span>
                    <a href="https://www.uniprot.org/uniprotkb/C5AQ99" target="_blank" class="term-link">
                        C5AQ99
                    </a>
                </span>
                
            </div>
            
            
            <div class="info-item">
                <span class="info-label">Organism:</span>
                <span>Methylorubrum extorquens AM1</span>
            </div>
            
            
            <div class="info-item">
                <span class="info-label">Review Status:</span>
                <span class="status-badge status-initialized">
                    INITIALIZED
                </span>
            </div>
            
            
        </div>
        <div style="margin-top: 1rem; text-align: center;">
            <a id="feedback-form-link"
               href="#"
               target="_blank"
               style="display: inline-block; padding: 10px 20px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 5px; font-weight: 600;">
                üìù Provide Detailed Feedback
            </a>
            <script>
                // Construct the form URL with proper encoding
                // Extract organism code from the current page path (e.g., /genes/ARATH/APO1/ -> ARATH)
                const pathParts = window.location.pathname.split('/');
                const genesIndex = pathParts.indexOf('genes');
                let organism = '';
                if (genesIndex !== -1 && pathParts[genesIndex + 1]) {
                    organism = pathParts[genesIndex + 1].toUpperCase();
                }
                const geneSymbol = "mxaD";
                const speciesGene = organism + ' ' + geneSymbol;
                const formBaseUrl = 'https://docs.google.com/forms/d/e/1FAIpQLSdTot9L6GVkkZYgLQT0E8ZdAJv8RiN5ZgOVkgWNcKSbYvxxzQ/viewform';
                const entryId = '1226477767'; // Correct entry ID for Species/Gene field
                const formUrl = formBaseUrl + '?entry.' + entryId + '=' + encodeURIComponent(speciesGene);
                const feedbackLink = document.getElementById('feedback-form-link');
                feedbackLink.href = formUrl;
                // Add tooltip showing the pre-filled value
                feedbackLink.title = 'Opens form with pre-filled: ' + speciesGene;
            </script>
        </div>
    </div>

    
    <div class="description-card">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>Gene Description</h2>
            <span class="vote-buttons" data-g="C5AQ99" data-a="DESCRIPTION: mxaD encodes a periplasmic protein of 176 amino ac..." data-r="" data-act="DESCRIPTION">
                <button class="vote-btn" data-v="up" title="Agree with this description">üëç</button>
                <button class="vote-btn" data-v="down" title="Disagree with this description">üëé</button>
            </span>
        </div>
        <p>mxaD encodes a periplasmic protein of 176 amino acids that is part of the mxa operon involved in calcium-dependent methanol oxidation. The protein contains an N-terminal signal peptide (residues 1-19) that directs it to the periplasm, where it likely functions in some aspect of Ca-dependent methanol dehydrogenase system assembly or regulation. MxaD contains a polyketide cyclase/dehydratase domain (Pfam PF10604) and belongs to the START-like domain superfamily, which typically bind lipids or other hydrophobic molecules. The precise molecular function of MxaD has not been experimentally determined, but its genomic location within the mxa operon indicates it is co-regulated with other methanol oxidation genes and likely plays an accessory role in the Ca-MDH system. The protein belongs to COG3832 and shows sequence similarity to other bacterial proteins of unknown function. Given the polyketide cyclase domain, MxaD may be involved in modifying or processing a cofactor or prosthetic group associated with the methanol oxidation machinery.</p>
    </div>
    

    

    

    
    <div class="section">
        <h2 class="section-title">Core Functions</h2>
        
        <div class="core-function-card">
            
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3>MxaD is a periplasmic protein of unknown precise function that is part of the mxa operon for calcium-dependent methanol oxidation. The protein contains a polyketide cyclase/dehydratase domain and belongs to the START-like domain superfamily, suggesting it may bind lipids or hydrophobic molecules. Its genomic context within the mxa operon strongly suggests involvement in the Ca-MDH system, possibly in cofactor modification, prosthetic group processing, or structural organization of the methanol oxidation machinery. The presence of a signal peptide directs MxaD to the periplasm, where the MxaFI methanol dehydrogenase complex is located. Experimental characterization is needed to determine its precise molecular function and role in methanol metabolism.</h3>
                <span class="vote-buttons" data-g="C5AQ99" data-a="FUNCTION: MxaD is a periplasmic protein of unknown precise f..." data-r="" data-act="CORE_FUNCTION">
                    <button class="vote-btn" data-v="up" title="Agree with this core function">üëç</button>
                    <button class="vote-btn" data-v="down" title="Disagree with this core function">üëé</button>
                </span>
            </div>
            

            <div class="core-function-terms">
                
                <div class="function-term-group">
                    <div class="function-term-label">Molecular Function:</div>
                    <span class="badge">
                        <a href="https://www.ebi.ac.uk/QuickGO/term/GO:0005488" target="_blank" class="term-link">
                            binding
                        </a>
                    </span>
                </div>
                

                
                <div class="function-term-group">
                    <div class="function-term-label">Directly Involved In:</div>
                    <div class="function-annotations">
                        
                        <span class="badge">
                            <a href="https://www.ebi.ac.uk/QuickGO/term/GO:0046170" target="_blank" class="term-link">
                                methanol catabolic process
                            </a>
                        </span>
                        
                    </div>
                </div>
                

                
                <div class="function-term-group">
                    <div class="function-term-label">Cellular Locations:</div>
                    <div class="function-annotations">
                        
                        <span class="badge">
                            <a href="https://www.ebi.ac.uk/QuickGO/term/GO:0042597" target="_blank" class="term-link">
                                periplasmic space
                            </a>
                        </span>
                        
                    </div>
                </div>
                

                

                
            </div>

            
            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                <strong>Supporting Evidence:</strong>
                <ul class="findings-list">
                    
                    <li class="finding-item">
                        <span class="reference-id">
                            
                            file:METEA/mxaD/mxaD-uniprot.txt
                            
                        </span>
                        
                        <div class="finding-text">MxaD protein...SIGNAL 1..19...Polyketide_cyc2 domain...START-like domain superfamily... Part of mxa operon</div>
                        
                    </li>
                    
                </ul>
            </div>
            
        </div>
        
    </div>
    

    
    <div class="section">
        <h2 class="section-title collapsible">References</h2>
        <div class="collapse-content">
            
            <div class="reference-item">
                <div class="reference-header">
                    <span class="reference-id">
                        
                        file:METEA/mxaD/mxaD-uniprot.txt
                        
                    </span>
                </div>
                
                <div class="reference-title">UniProt entry for mxaD periplasmic protein with polyketide cyclase domain</div>
                
                
            </div>
            
        </div>
    </div>
    


    

    

    

    <!-- Additional Documentation Sections -->
    

    <!-- YAML Preview Section -->
    <div class="section">
        <details class="yaml-preview">
            <summary>
                <h2 style="display: inline;">üìÑ View Raw YAML</h2>
            </summary>
            <div class="yaml-content">
                <pre><code>id: C5AQ99
gene_symbol: mxaD
product_type: PROTEIN
taxon:
  id: NCBITaxon:272630
  label: Methylorubrum extorquens AM1
description: mxaD encodes a periplasmic protein of 176 amino acids that is part of
  the mxa operon involved in calcium-dependent methanol oxidation. The protein contains
  an N-terminal signal peptide (residues 1-19) that directs it to the periplasm, where
  it likely functions in some aspect of Ca-dependent methanol dehydrogenase system
  assembly or regulation. MxaD contains a polyketide cyclase/dehydratase domain (Pfam
  PF10604) and belongs to the START-like domain superfamily, which typically bind
  lipids or other hydrophobic molecules. The precise molecular function of MxaD has
  not been experimentally determined, but its genomic location within the mxa operon
  indicates it is co-regulated with other methanol oxidation genes and likely plays
  an accessory role in the Ca-MDH system. The protein belongs to COG3832 and shows
  sequence similarity to other bacterial proteins of unknown function. Given the polyketide
  cyclase domain, MxaD may be involved in modifying or processing a cofactor or prosthetic
  group associated with the methanol oxidation machinery.
existing_annotations: []
core_functions:
- description: MxaD is a periplasmic protein of unknown precise function that is part
    of the mxa operon for calcium-dependent methanol oxidation. The protein contains
    a polyketide cyclase/dehydratase domain and belongs to the START-like domain superfamily,
    suggesting it may bind lipids or hydrophobic molecules. Its genomic context within
    the mxa operon strongly suggests involvement in the Ca-MDH system, possibly in
    cofactor modification, prosthetic group processing, or structural organization
    of the methanol oxidation machinery. The presence of a signal peptide directs
    MxaD to the periplasm, where the MxaFI methanol dehydrogenase complex is located.
    Experimental characterization is needed to determine its precise molecular function
    and role in methanol metabolism.
  molecular_function:
    id: GO:0005488
    label: binding
  directly_involved_in:
  - id: GO:0046170
    label: methanol catabolic process
  locations:
  - id: GO:0042597
    label: periplasmic space
  supported_by:
  - reference_id: file:METEA/mxaD/mxaD-uniprot.txt
    supporting_text: MxaD protein...SIGNAL 1..19...Polyketide_cyc2 domain...START-like
      domain superfamily... Part of mxa operon
references:
- id: file:METEA/mxaD/mxaD-uniprot.txt
  title: UniProt entry for mxaD periplasmic protein with polyketide cyclase domain
  findings: []
status: INITIALIZED
</code></pre>
            </div>
        </details>
    </div>

    <!-- Pathway Visualization Link -->
    

    <style>
        /* Markdown Section Styles */
        .markdown-section {
            margin-bottom: 1rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1rem;
            background-color: #f8f9fa;
        }

        .markdown-section summary {
            cursor: pointer;
            user-select: none;
        }

        .markdown-section summary h3 {
            margin: 0;
            color: #495057;
            font-size: 1.1rem;
        }

        .markdown-section summary:hover h3 {
            color: #007bff;
        }

        .markdown-section[open] {
            background-color: #fff;
        }

        .markdown-content {
            margin-top: 1rem;
            padding: 1rem;
            border-top: 1px solid #dee2e6;
        }

        /* Markdown content styling */
        .markdown-content h1 { font-size: 1.5rem; margin-top: 1.5rem; }
        .markdown-content h2 { font-size: 1.3rem; margin-top: 1.3rem; }
        .markdown-content h3 { font-size: 1.1rem; margin-top: 1.1rem; }
        .markdown-content h4 { font-size: 1rem; margin-top: 1rem; }

        .markdown-content pre {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        .markdown-content code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
        }

        .markdown-content pre code {
            background: none;
            padding: 0;
        }

        .markdown-content table {
            border-collapse: collapse;
            width: 100%;
            margin: 1rem 0;
        }

        .markdown-content table th,
        .markdown-content table td {
            border: 1px solid #dee2e6;
            padding: 0.5rem;
            text-align: left;
        }

        .markdown-content table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        .markdown-content blockquote {
            border-left: 4px solid #007bff;
            padding-left: 1rem;
            margin-left: 0;
            color: #666;
        }

        /* YAML Preview Styles */
        .yaml-preview {
            margin-top: 2rem;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 1rem;
            background-color: #f8f9fa;
        }

        .yaml-preview summary {
            cursor: pointer;
            user-select: none;
        }

        .yaml-preview summary h2 {
            margin: 0;
            color: #495057;
            font-size: 1.3rem;
        }

        .yaml-preview summary:hover h2 {
            color: #007bff;
        }

        .yaml-preview[open] {
            background-color: #fff;
        }

        .yaml-content {
            margin-top: 1rem;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        .yaml-content pre {
            margin: 0;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .yaml-content code {
            color: #333;
            background: none;
            padding: 0;
        }

        /* Pathway Link Styles */
        .pathway-link {
            margin: 1rem 0;
        }

        .btn-link {
            display: inline-block;
            padding: 0.5rem 1rem;
            background-color: #007bff;
            color: white !important;
            text-decoration: none;
            border-radius: 4px;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .btn-link:hover {
            background-color: #0056b3;
            text-decoration: none;
        }

        /* Voting buttons */
        .vote-buttons {
            display: inline-block;
            margin-left: 0.5rem;
        }

        .vote-btn {
            background: none;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 2px 6px;
            margin: 0 2px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            opacity: 0.6;
        }

        .vote-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .vote-btn.voted {
            opacity: 1;
            border-color: #28a745;
            background-color: #d4edda;
        }

        .vote-btn.voted-down {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
    </style>

    <script>
        // Add collapsible functionality
        document.querySelectorAll('.collapsible').forEach(element => {
            element.addEventListener('click', function() {
                this.classList.toggle('collapsed');
            });
        });

        // Voting functionality
        const VOTE_URL = 'https://script.google.com/macros/s/AKfycbwPKH7d3seuPNBtB0ugVjqGeTiByyOGD5vkqB_Ck6K8eOcPQYbJqBOuz6GFgXHKBNWK/exec';

        // Get or create session ID
        let sessionId = localStorage.getItem('review_session_id');
        if (!sessionId) {
            sessionId = 's' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            localStorage.setItem('review_session_id', sessionId);
        }

        // Show previous votes on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.vote-buttons').forEach(container => {
                const key = `vote_${container.dataset.g}_${container.dataset.a}_${container.dataset.act}`;
                const previousVote = localStorage.getItem(key);
                if (previousVote) {
                    const btn = container.querySelector(`[data-v="${previousVote}"]`);
                    if (btn) btn.classList.add(previousVote === 'up' ? 'voted' : 'voted-down');
                }
            });
        });

        // Handle vote clicks - Simple image beacon approach
        document.addEventListener('click', function(e) {
            if (!e.target.classList.contains('vote-btn')) return;

            // Prevent the click from bubbling to parent elements (like summary)
            e.preventDefault();
            e.stopPropagation();

            const btn = e.target;
            const container = btn.closest('.vote-buttons');
            if (!container) return;

            const voteType = btn.dataset.v;

            // Check if already voted (locally)
            const key = `vote_${container.dataset.g}_${container.dataset.a}_${container.dataset.act}`;
            const previousVote = localStorage.getItem(key);

            if (previousVote === voteType) {
                // Same vote - do nothing
                btn.style.animation = 'shake 0.5s';
                setTimeout(() => btn.style.animation = '', 500);
                return;
            }

            // Build URL
            const params = new URLSearchParams({
                gene_id: container.dataset.g,
                annotation_id: container.dataset.a,
                ref_id: container.dataset.r || '',
                action: container.dataset.act,
                vote: voteType,
                session_id: sessionId,
                ua: navigator.userAgent.substring(0, 100)
            });

            // Clear previous vote styling
            container.querySelectorAll('.vote-btn').forEach(b => {
                b.classList.remove('voted', 'voted-down');
            });

            // Apply new vote styling immediately (optimistic UI)
            btn.classList.add(voteType === 'up' ? 'voted' : 'voted-down');

            // Store locally
            localStorage.setItem(key, voteType);

            // Send vote using fetch with no-cors mode (fire and forget)
            const fullUrl = VOTE_URL + '?' + params;
            console.log('Sending vote to:', fullUrl);

            // Use fetch in no-cors mode - we won't get a response but the request will be sent
            fetch(fullUrl, {
                mode: 'no-cors',
                method: 'GET'
            }).then(() => {
                console.log('Vote request sent (no response due to no-cors mode)');
            }).catch(err => {
                console.warn('Vote may not have been recorded, but saved locally:', err);

                // Fallback: try image beacon as well
                const img = new Image();
                img.src = fullUrl;
            });
        });

        // Optional: Add shake animation for feedback
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                75% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>